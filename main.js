!function(){"use strict";class e{constructor(e,t,r,s,i){this._data=e,this._cardSelector=t,this._handleImageClick=r,this._handleLikeClick=i,this._openDeleteCardPopup=s,this._selectors={image:".card__image",title:".card__title",likeButton:".card__like-button",likeButtonActive:"card__like-button_checked",deleteButton:".card__trash",cardItem:".card"}}_getTemplate(){return document.querySelector(this._cardSelector).content.cloneNode(!0)}_setCardContent(){const{name:e,link:t,_id:r,isLiked:s}=this._data;this._cardItem.id=`card_${r}`,this._cardImageElement.src=t,this._cardImageElement.alt=e,this._cardImageElement.name=e,this._title.textContent=e,this._cardItem.isLiked=s}_handleLikeButton(e){e.preventDefault(),e.target.classList.toggle(this._selectors.likeButtonActive),this._handleLikeClick({cardId:this._cardItem.id,method:this._cardItem.isLiked?"DELETE":"PUT"}),this._cardItem.isLiked=!this._cardItem.isLiked}_setEventListeners(){this._likeButton.addEventListener("click",(e=>this._handleLikeButton(e))),this._deleteButton.addEventListener("click",(()=>{this._openDeleteCardPopup({cardId:this._cardItem.id})})),this._cardImageElement.addEventListener("click",(()=>this._handleImageClick(this._data)))}generateCard(){return this._cardElement=this._getTemplate(),this._title=this._cardElement.querySelector(this._selectors.title),this._cardImageElement=this._cardElement.querySelector(this._selectors.image),this._likeButton=this._cardElement.querySelector(this._selectors.likeButton),this._deleteButton=this._cardElement.querySelector(this._selectors.deleteButton),this._cardItem=this._cardElement.querySelector(this._selectors.cardItem),this._setCardContent(),this._setEventListeners(),this._data.isLiked&&this._likeButton.classList.toggle(this._selectors.likeButtonActive),this._cardElement}}class t{constructor(e,t){const{inputSelector:r,submitButtonSelector:s,inactiveButtonClass:i,inputErrorClass:o,errorClass:n}=e;this._inputSelector=r,this._submitButtonSelector=s,this._inactiveButtonClass=i,this._inputErrorClass=o,this._errorClass=n,this._formElement=t,this._buttonElement=this._formElement.querySelector(s),this._inputList=Array.from(t.querySelectorAll(r))}_getErrorElement(e){return this._formElement.querySelector(`.${e.name}-input-error`)}_showError(e){const t=this._getErrorElement(e);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass),this.toggleButtonState()}_hideError(e){const t=this._getErrorElement(e);e.classList.remove(this._inputErrorClass),t.textContent="",this.toggleButtonState()}_checkInputValidity(e){e.validity.valid?this._hideError(e):this._showError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>this._checkInputValidity(e)))})),this.toggleButtonState()}toggleButtonState(){const e=this._hasInvalidInput();this._buttonElement.classList.toggle(this._inactiveButtonClass,e),this._buttonElement.disabled=e}enableValidation(){this._setEventListeners()}resetValidation(){this._inputList.forEach((e=>{this._hideError(e)})),this.toggleButtonState()}}const r={pageSelector:".page",profileModalSelector:".page__profile-modal",placeModalSelector:".page__place-modal",imageModalSelector:".page__image-modal",profileNameSelector:".profile__name",profileJobSelector:".profile__job",profileImageSelector:".profile__avatar",cardsListSelector:".places__list",closeModalButtonSelector:".modal__close-button",modalImageSelector:".modal__image",modalImageTitleSelector:".modal__title",deleteCardModalSelector:".page__delete-card-modal",editAvatarModalSelector:".page__edit-avatar-modal"},{pageSelector:s,closeModalButtonSelector:i}=r;class o{constructor(e){let{selector:t}=e;this._popup=document.querySelector(t),this._page=document.querySelector(s)}open(){this._popup.classList.add("modal_opened"),this._page.addEventListener("keydown",this._handleEscClose),this._page.addEventListener("click",this._handleOverlayClick)}close(){this._popup.classList.remove("modal_opened"),this._page.removeEventListener("keydown",this._handleEscClose),this._page.removeEventListener("click",this._handleOverlayClick)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleOverlayClick=e=>{e.target===this._popup&&this.close()};setEventListeners(){this._closeButton=this._popup.querySelector(i),this._closeButton.addEventListener("click",(()=>{this.close()}))}}class n extends o{constructor(e,t){super({selector:e}),this._handleFormSubmit=t,this._inputList=this._popup.querySelectorAll(".form__input"),this._form=this._popup.querySelector(".form"),this._submitBtn=this._form.querySelector("[type='submit']"),this._submitBtnText=this._submitBtn.textContent}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}getForm(){return this._form}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}const{modalImageSelector:a,modalImageTitleSelector:l}=r,c=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{headers:this._headers})}editUserInfo(e){let{name:t,job:r}=e;return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})})}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getData(){return Promise.all([this.getUserInfo(),this.getInitialCards()]).then((e=>{let[t,r]=e;return{userInfo:t,cards:r}}))}addCard(e){let{name:t,link:r}=e;return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})})}deleteCard(e){let{cardId:t}=e;return this._request(`${this._baseUrl}/cards/${t.slice(5)}`,{method:"DELETE",headers:this._headers})}likeCard(e){let{cardId:t,method:r}=e;return this._request(`${this._baseUrl}/cards/${t.slice(5)}/likes`,{method:r,headers:this._headers})}editAvatarUrl(e){let{url:t}=e;return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"19c5994b-226e-4f78-a8d2-c207c10029fd","Content-Type":"application/json"}}),{profileModalSelector:d,placeModalSelector:h,imageModalSelector:_,profileNameSelector:u,profileJobSelector:m,profileImageSelector:p,cardsListSelector:g,deleteCardModalSelector:f,editAvatarModalSelector:E}=r,v=document.querySelector(".profile__edit-button"),S=document.querySelector(".profile__add-button"),I=document.querySelector(".profile__avatar-container"),b={},L=new class{constructor(e,t){let{renderer:r}=e;this._renderer=r,this._container=document.querySelector(t)}setItems(e){this._items=e}renderItems(e){e.forEach((e=>{const t=this._renderer(e);this.addItem(t,{method:"prepend"})}))}addItem(e,t){let{method:r}=t;this._container[r](e)}}({renderer:t=>(t=>new e(t,"#card-template",j,A,T).generateCard())(t)},g),C=new class{constructor(e){let{nameSelector:t,jobSelector:r,profileImageSelector:s}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(r),this._profileImage=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,avatarUrl:this._profileImage.src}}setUserInfo(e){let{name:t,job:r,avatarUrl:s=this._profileImage.src}=e;this._nameElement.textContent=t,this._jobElement.textContent=r,this.setAvatar({avatarUrl:s})}setAvatar(e){let{avatarUrl:t}=e;this._profileImage.src=t}}({nameSelector:u,jobSelector:m,profileImageSelector:p});c.getData().then((e=>{let{userInfo:t,cards:r}=e;const{name:s,about:i,avatar:o}=t;C.setUserInfo({name:s,job:i,avatarUrl:o}),L.renderItems(r.reverse())})).catch((e=>console.error("Error fetching user data and cards:",e)));const k=new n(d,(function(e){let{name:t,job:r}=e;x((function(){return c.editUserInfo({name:t,job:r}).then((e=>{let{name:t,about:r}=e;C.setUserInfo({name:t,job:r})}))}),k)}));k.setEventListeners();const y=new n(h,(function(e){let{title:t,url:r}=e;const s={name:t,link:r};x((function(){return c.addCard(s).then((e=>{L.renderItems([e]),b["place-form"].toggleButtonState()}))}),y)}));y.setEventListeners();const B=new n(E,(function(e){let{url:t}=e;x((function(){return c.editAvatarUrl({url:t}).then((()=>{C.setAvatar({avatarUrl:t})}))}),B)}));B.setEventListeners();const q=new class extends o{constructor(e){super({selector:e}),this._imageElement=this._popup.querySelector(a),this._imageTitle=this._popup.querySelector(l)}open(e){let{name:t,link:r}=e;this._imageElement.src=r,this._imageElement.alt=t,this._imageTitle.textContent=t,super.open()}}(_);q.setEventListeners();const U=new class extends o{constructor(e,t){super({selector:e}),this._confirmButton=this._popup.querySelector(".form__save-button"),this._deleteCard=t}setEventListeners(){this._confirmButton.addEventListener("click",(e=>{e.preventDefault(),this._deleteCard(this._cardId)})),super.setEventListeners()}setCardId(e){this._cardId=e}}(f,(function(e){c.deleteCard({cardId:e}).then((()=>{document.querySelector(`#${e}`).remove(),U.close()})).catch((e=>console.error("Error deleting the card:",e))).finally((()=>{b["confirm-card-delete-form"].resetValidation()}))}));function j(e){q.open(e)}function A(e){let{cardId:t}=e;U.setCardId(t),U.open()}function x(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.renderLoading(!0,r),e().then((()=>{t.close(),t.getForm().reset()})).catch((e=>console.error("Error:",e))).finally((()=>{t.renderLoading(!1)}))}function T(e){let{cardId:t,method:r}=e;c.likeCard({cardId:t,method:r}).catch((e=>console.error("Error during like click:",e)))}var V;U.setEventListeners(),v.addEventListener("click",(function(){const{name:e,job:t}=C.getUserInfo();k.setInputValues({name:e,job:t}),b["profile-form"].resetValidation(),k.open()})),S.addEventListener("click",(function(){b["place-form"].toggleButtonState(),y.open()})),I.addEventListener("click",(function(){const{avatarUrl:e}=C.getUserInfo();B.setInputValues({url:e}),B.open()})),V={inputSelector:".form__input",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__save-button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},Array.from(document.forms).forEach((e=>{const r=new t(V,e);r.enableValidation(),b[e.getAttribute("name")]=r}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dENjLEVBQWdCekcsTUFDbEIsSUE2RTBCekQsRUxoSkssQ0FDN0JFLGNBQWUsZUFDZkMscUJBQXNCLHFCQUN0QkMsb0JBQXFCLDZCQUNyQkMsZ0JBQWlCLHlCQUNqQkMsV0FBWSw0Qks0SUtTLE1BQU1DLEtBQUsvQyxTQUFTOE0sT0FDNUI5SSxTQUFTaEMsSUFDaEIsTUFBTStLLEVBQVksSUFBSWpMLEVBQWNDLEVBQVVDLEdBQzlDK0ssRUFBVTVJLG1CQUNWNEYsRUFBZS9ILEVBQVlnTCxhQUFhLFNBQVdELENBQVMsRyIsInNvdXJjZXMiOlsid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBvcGVuRGVsZXRlQ2FyZFBvcHVwLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApIHtcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX29wZW5EZWxldGVDYXJkUG9wdXAgPSBvcGVuRGVsZXRlQ2FyZFBvcHVwO1xuXG4gICAgdGhpcy5fc2VsZWN0b3JzID0ge1xuICAgICAgaW1hZ2U6IFwiLmNhcmRfX2ltYWdlXCIsXG4gICAgICB0aXRsZTogXCIuY2FyZF9fdGl0bGVcIixcbiAgICAgIGxpa2VCdXR0b246IFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIsXG4gICAgICBsaWtlQnV0dG9uQWN0aXZlOiBcImNhcmRfX2xpa2UtYnV0dG9uX2NoZWNrZWRcIixcbiAgICAgIGRlbGV0ZUJ1dHRvbjogXCIuY2FyZF9fdHJhc2hcIixcbiAgICAgIGNhcmRJdGVtOiBcIi5jYXJkXCIsXG4gICAgfTtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgX3NldENhcmRDb250ZW50KCkge1xuICAgIGNvbnN0IHsgbmFtZSwgbGluaywgX2lkLCBpc0xpa2VkIH0gPSB0aGlzLl9kYXRhO1xuICAgIHRoaXMuX2NhcmRJdGVtLmlkID0gYGNhcmRfJHtfaWR9YDtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSBuYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2NhcmRJdGVtLmlzTGlrZWQgPSBpc0xpa2VkO1xuICB9XG5cbiAgX2hhbmRsZUxpa2VCdXR0b24oZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKHRoaXMuX3NlbGVjdG9ycy5saWtlQnV0dG9uQWN0aXZlKTtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2soe1xuICAgICAgY2FyZElkOiB0aGlzLl9jYXJkSXRlbS5pZCxcbiAgICAgIG1ldGhvZDogdGhpcy5fY2FyZEl0ZW0uaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxuICAgIH0pO1xuICAgIHRoaXMuX2NhcmRJdGVtLmlzTGlrZWQgPSAhdGhpcy5fY2FyZEl0ZW0uaXNMaWtlZDtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PlxuICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbihldnQpXG4gICAgKTtcblxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5fb3BlbkRlbGV0ZUNhcmRQb3B1cCh7IGNhcmRJZDogdGhpcy5fY2FyZEl0ZW0uaWQgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9kYXRhKVxuICAgICk7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX3RpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcnMudGl0bGUpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2VsZWN0b3JzLmltYWdlXG4gICAgKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3NlbGVjdG9ycy5saWtlQnV0dG9uXG4gICAgKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2VsZWN0b3JzLmRlbGV0ZUJ1dHRvblxuICAgICk7XG4gICAgdGhpcy5fY2FyZEl0ZW0gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9ycy5jYXJkSXRlbSk7XG5cbiAgICB0aGlzLl9zZXRDYXJkQ29udGVudCgpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICBpZiAodGhpcy5fZGF0YS5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUodGhpcy5fc2VsZWN0b3JzLmxpa2VCdXR0b25BY3RpdmUpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgY29uc3Qge1xuICAgICAgaW5wdXRTZWxlY3RvcixcbiAgICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yLFxuICAgICAgaW5hY3RpdmVCdXR0b25DbGFzcyxcbiAgICAgIGlucHV0RXJyb3JDbGFzcyxcbiAgICAgIGVycm9yQ2xhc3MsXG4gICAgfSA9IHNldHRpbmdzO1xuXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBpbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcblxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvcikpO1xuICB9XG5cbiAgX2dldEVycm9yRWxlbWVudChpbnB1dEVsZW1lbnQpIHtcbiAgICByZXR1cm4gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50Lm5hbWV9LWlucHV0LWVycm9yYCk7XG4gIH1cblxuICBfc2hvd0Vycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2dldEVycm9yRWxlbWVudChpbnB1dEVsZW1lbnQpO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIF9oaWRlRXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZ2V0RXJyb3JFbGVtZW50KGlucHV0RWxlbWVudCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXG4gICAgICA/IHRoaXMuX2hpZGVFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICA6IHRoaXMuX3Nob3dFcnJvcihpbnB1dEVsZW1lbnQpO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiAhaW5wdXQudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkpO1xuICAgIH0pO1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGNvbnN0IGlzSW52YWxpZCA9IHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzLCBpc0ludmFsaWQpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBpc0ludmFsaWQ7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXQpO1xuICAgIH0pO1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxufVxuIiwiY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgcGFnZVNlbGVjdG9yOiBcIi5wYWdlXCIsXG4gIHByb2ZpbGVNb2RhbFNlbGVjdG9yOiBcIi5wYWdlX19wcm9maWxlLW1vZGFsXCIsXG4gIHBsYWNlTW9kYWxTZWxlY3RvcjogXCIucGFnZV9fcGxhY2UtbW9kYWxcIixcbiAgaW1hZ2VNb2RhbFNlbGVjdG9yOiBcIi5wYWdlX19pbWFnZS1tb2RhbFwiLFxuICBwcm9maWxlTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIHByb2ZpbGVKb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fam9iXCIsXG4gIHByb2ZpbGVJbWFnZVNlbGVjdG9yOiBcIi5wcm9maWxlX19hdmF0YXJcIixcbiAgY2FyZHNMaXN0U2VsZWN0b3I6IFwiLnBsYWNlc19fbGlzdFwiLFxuICBjbG9zZU1vZGFsQnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19jbG9zZS1idXR0b25cIixcbiAgbW9kYWxJbWFnZVNlbGVjdG9yOiBcIi5tb2RhbF9faW1hZ2VcIixcbiAgbW9kYWxJbWFnZVRpdGxlU2VsZWN0b3I6IFwiLm1vZGFsX190aXRsZVwiLFxuICBkZWxldGVDYXJkTW9kYWxTZWxlY3RvcjogXCIucGFnZV9fZGVsZXRlLWNhcmQtbW9kYWxcIixcbiAgZWRpdEF2YXRhck1vZGFsU2VsZWN0b3I6IFwiLnBhZ2VfX2VkaXQtYXZhdGFyLW1vZGFsXCIsXG59O1xuXG5jb25zdCBmb3JtVmFsaWRhdGlvblNldHRpbmdzID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fc2F2ZS1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19zYXZlLWJ1dHRvbl9pbmFjdGl2ZVwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxufTtcblxuY29uc3QgdG9rZW4gPSBcIjE5YzU5OTRiLTIyNmUtNGY3OC1hOGQyLWMyMDdjMTAwMjlmZFwiO1xuXG5leHBvcnQgeyBpbml0aWFsQ2FyZHMsIHNlbGVjdG9ycywgZm9ybVZhbGlkYXRpb25TZXR0aW5ncywgdG9rZW4gfTtcbiIsImltcG9ydCB7IHNlbGVjdG9ycyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuY29uc3QgeyBwYWdlU2VsZWN0b3IsIGNsb3NlTW9kYWxCdXR0b25TZWxlY3RvciB9ID0gc2VsZWN0b3JzO1xuXG5leHBvcnQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICAgIHRoaXMuX3BhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBhZ2VTZWxlY3Rvcik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgdGhpcy5fcGFnZS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcGFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsaWNrKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgdGhpcy5fcGFnZS5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcGFnZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsaWNrKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlT3ZlcmxheUNsaWNrID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cCkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoY2xvc2VNb2RhbEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgc2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIlt0eXBlPSdzdWJtaXQnXVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChcbiAgICAgIChpbnB1dCkgPT4gKHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZSlcbiAgICApO1xuXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XG4gIH1cblxuICBnZXRGb3JtKCkge1xuICAgIHJldHVybiB0aGlzLl9mb3JtO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdG5UZXh0O1xuICAgIH1cbiAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5pbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNvbnN0IHsgbW9kYWxJbWFnZVNlbGVjdG9yLCBtb2RhbEltYWdlVGl0bGVTZWxlY3RvciB9ID0gc2VsZWN0b3JzO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBzZWxlY3RvciB9KTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKG1vZGFsSW1hZ2VTZWxlY3Rvcik7XG4gICAgdGhpcy5faW1hZ2VUaXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IobW9kYWxJbWFnZVRpdGxlU2VsZWN0b3IpO1xuICB9XG5cbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBuYW1lO1xuICAgIHRoaXMuX2ltYWdlVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgdG9rZW4gfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGpvYiB9KSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGFib3V0OiBqb2IsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBnZXREYXRhKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSkudGhlbihcbiAgICAgIChbdXNlckluZm8sIGNhcmRzXSkgPT4ge1xuICAgICAgICByZXR1cm4geyB1c2VySW5mbywgY2FyZHMgfTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoeyBjYXJkSWQgfSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkLnNsaWNlKDUpfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBsaWtlQ2FyZCh7IGNhcmRJZCwgbWV0aG9kIH0pIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZC5zbGljZSg1KX0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBlZGl0QXZhdGFyVXJsKHsgdXJsIH0pIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogdXJsIH0pLFxuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogdG9rZW4sXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcbiIsImltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhDb25maXJtYXRpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCB7IGFwaSB9IGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IHsgc2VsZWN0b3JzLCBmb3JtVmFsaWRhdGlvblNldHRpbmdzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5jb25zdCB7XG4gIHByb2ZpbGVNb2RhbFNlbGVjdG9yLFxuICBwbGFjZU1vZGFsU2VsZWN0b3IsXG4gIGltYWdlTW9kYWxTZWxlY3RvcixcbiAgcHJvZmlsZU5hbWVTZWxlY3RvcixcbiAgcHJvZmlsZUpvYlNlbGVjdG9yLFxuICBwcm9maWxlSW1hZ2VTZWxlY3RvcixcbiAgY2FyZHNMaXN0U2VsZWN0b3IsXG4gIGRlbGV0ZUNhcmRNb2RhbFNlbGVjdG9yLFxuICBlZGl0QXZhdGFyTW9kYWxTZWxlY3Rvcixcbn0gPSBzZWxlY3RvcnM7XG5cbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGFkZFBsYWNlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgZWRpdEF2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1jb250YWluZXJcIik7XG5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmNvbnN0IGdldENhcmRFbGVtZW50ID0gKGl0ZW0pID0+IHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGl0ZW0sXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgb3BlbkRlbGV0ZUNhcmRQb3B1cCxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59O1xuXG5jb25zdCBjYXJkc0xpc3QgPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4gZ2V0Q2FyZEVsZW1lbnQoaXRlbSksXG4gIH0sXG4gIGNhcmRzTGlzdFNlbGVjdG9yXG4pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogcHJvZmlsZU5hbWVTZWxlY3RvcixcbiAgam9iU2VsZWN0b3I6IHByb2ZpbGVKb2JTZWxlY3RvcixcbiAgcHJvZmlsZUltYWdlU2VsZWN0b3I6IHByb2ZpbGVJbWFnZVNlbGVjdG9yLFxufSk7XG5cbmFwaVxuICAuZ2V0RGF0YSgpXG4gIC50aGVuKCh7IHVzZXJJbmZvOiB1c2VyRGF0YSwgY2FyZHMgfSkgPT4ge1xuICAgIGNvbnN0IHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9ID0gdXNlckRhdGE7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZSxcbiAgICAgIGpvYjogYWJvdXQsXG4gICAgICBhdmF0YXJVcmw6IGF2YXRhcixcbiAgICB9KTtcbiAgICBjYXJkc0xpc3QucmVuZGVySXRlbXMoY2FyZHMucmV2ZXJzZSgpKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGRhdGEgYW5kIGNhcmRzOlwiLCBlcnIpKTtcblxuY29uc3QgcHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHByb2ZpbGVNb2RhbFNlbGVjdG9yLFxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdFxuKTtcbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhZGRQbGFjZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHBsYWNlTW9kYWxTZWxlY3RvcixcbiAgaGFuZGxlQWRkUGxhY2VGb3JtU3VibWl0XG4pO1xuYWRkUGxhY2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgZWRpdEF2YXRhck1vZGFsU2VsZWN0b3IsXG4gIGhhbmRsZUVkaXRBdmF0YXJTdWJtaXRcbik7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShpbWFnZU1vZGFsU2VsZWN0b3IpO1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFxuICBkZWxldGVDYXJkTW9kYWxTZWxlY3RvcixcbiAgZGVsZXRlQ2FyZFxuKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBlZGl0UHJvZmlsZSgpIHtcbiAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVQb3B1cC5zZXRJbnB1dFZhbHVlcyh7IG5hbWUsIGpvYiB9KTtcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XG59XG5cbmZ1bmN0aW9uIGFkZFBsYWNlKCkge1xuICBmb3JtVmFsaWRhdG9yc1tcInBsYWNlLWZvcm1cIl0udG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgYWRkUGxhY2VQb3B1cC5vcGVuKCk7XG59XG5cbmZ1bmN0aW9uIGVkaXRBdmF0YXIoKSB7XG4gIGNvbnN0IHsgYXZhdGFyVXJsIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBlZGl0QXZhdGFyUG9wdXAuc2V0SW5wdXRWYWx1ZXMoeyB1cmw6IGF2YXRhclVybCB9KTtcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhkYXRhKSB7XG4gIGltYWdlUG9wdXAub3BlbihkYXRhKTtcbn1cblxuZnVuY3Rpb24gb3BlbkRlbGV0ZUNhcmRQb3B1cCh7IGNhcmRJZCB9KSB7XG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRDYXJkSWQoY2FyZElkKTtcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlU3VibWl0KHJlcXVlc3QsIHBvcHVwSW5zdGFuY2UsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICBwb3B1cEluc3RhbmNlLnJlbmRlckxvYWRpbmcodHJ1ZSwgbG9hZGluZ1RleHQpO1xuXG4gIHJlcXVlc3QoKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHBvcHVwSW5zdGFuY2UuY2xvc2UoKTtcbiAgICAgIHBvcHVwSW5zdGFuY2UuZ2V0Rm9ybSgpLnJlc2V0KCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnIpKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHBvcHVwSW5zdGFuY2UucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KHsgbmFtZSwgam9iIH0pIHtcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XG4gICAgcmV0dXJuIGFwaS5lZGl0VXNlckluZm8oeyBuYW1lLCBqb2IgfSkudGhlbigoeyBuYW1lLCBhYm91dDogam9iIH0pID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBwcm9maWxlUG9wdXApO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRQbGFjZUZvcm1TdWJtaXQoeyB0aXRsZSwgdXJsIH0pIHtcbiAgY29uc3QgbmV3Q2FyZCA9IHsgbmFtZTogdGl0bGUsIGxpbms6IHVybCB9O1xuXG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGkuYWRkQ2FyZChuZXdDYXJkKS50aGVuKChzYXZlZENhcmQpID0+IHtcbiAgICAgIGNhcmRzTGlzdC5yZW5kZXJJdGVtcyhbc2F2ZWRDYXJkXSk7XG4gICAgICBmb3JtVmFsaWRhdG9yc1tcInBsYWNlLWZvcm1cIl0udG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgYWRkUGxhY2VQb3B1cCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRBdmF0YXJTdWJtaXQoeyB1cmwgfSkge1xuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcbiAgICByZXR1cm4gYXBpLmVkaXRBdmF0YXJVcmwoeyB1cmwgfSkudGhlbigoKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRBdmF0YXIoeyBhdmF0YXJVcmw6IHVybCB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZWRpdEF2YXRhclBvcHVwKTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoeyBjYXJkSWQgfSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtjYXJkSWR9YCkucmVtb3ZlKCk7XG4gICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgdGhlIGNhcmQ6XCIsIGVycikpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZm9ybVZhbGlkYXRvcnNbXCJjb25maXJtLWNhcmQtZGVsZXRlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayh7IGNhcmRJZCwgbWV0aG9kIH0pIHtcbiAgYXBpXG4gICAgLmxpa2VDYXJkKHsgY2FyZElkLCBtZXRob2QgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGR1cmluZyBsaWtlIGNsaWNrOlwiLCBlcnIpKTtcbn1cblxuZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncykge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQuZm9ybXMpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCk7XG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXSA9IHZhbGlkYXRvcjtcbiAgfSk7XG59XG5cbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlZGl0UHJvZmlsZSk7XG5hZGRQbGFjZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYWRkUGxhY2UpO1xuZWRpdEF2YXRhckVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGVkaXRBdmF0YXIpO1xuXG5lbmFibGVWYWxpZGF0aW9uKGZvcm1WYWxpZGF0aW9uU2V0dGluZ3MpO1xuIiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHNldEl0ZW1zKGl0ZW1zKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICAgIHRoaXMuYWRkSXRlbShjYXJkRWxlbWVudCwgeyBtZXRob2Q6IFwicHJlcGVuZFwiIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50LCB7IG1ldGhvZCB9KSB7XG4gICAgdGhpcy5fY29udGFpbmVyW21ldGhvZF0oZWxlbWVudCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgcHJvZmlsZUltYWdlU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVJbWFnZVNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhclVybDogdGhpcy5fcHJvZmlsZUltYWdlLnNyYyxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBqb2IsIGF2YXRhclVybCA9IHRoaXMuX3Byb2ZpbGVJbWFnZS5zcmMgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xuICAgIHRoaXMuc2V0QXZhdGFyKHsgYXZhdGFyVXJsIH0pO1xuICB9XG5cbiAgc2V0QXZhdGFyKHsgYXZhdGFyVXJsIH0pIHtcbiAgICB0aGlzLl9wcm9maWxlSW1hZ2Uuc3JjID0gYXZhdGFyVXJsO1xuICB9XG59XG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBkZWxldGVDYXJkKSB7XG4gICAgc3VwZXIoeyBzZWxlY3RvciB9KTtcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zYXZlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9kZWxldGVDYXJkID0gZGVsZXRlQ2FyZDtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5fZGVsZXRlQ2FyZCh0aGlzLl9jYXJkSWQpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBzZXRDYXJkSWQoY2FyZElkKSB7XG4gICAgdGhpcy5fY2FyZElkID0gY2FyZElkO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJvcGVuRGVsZXRlQ2FyZFBvcHVwIiwiaGFuZGxlTGlrZUNsaWNrIiwidGhpcyIsIl9kYXRhIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9vcGVuRGVsZXRlQ2FyZFBvcHVwIiwiX3NlbGVjdG9ycyIsImltYWdlIiwidGl0bGUiLCJsaWtlQnV0dG9uIiwibGlrZUJ1dHRvbkFjdGl2ZSIsImRlbGV0ZUJ1dHRvbiIsImNhcmRJdGVtIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRDYXJkQ29udGVudCIsIm5hbWUiLCJsaW5rIiwiX2lkIiwiaXNMaWtlZCIsIl9jYXJkSXRlbSIsImlkIiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJzcmMiLCJhbHQiLCJfdGl0bGUiLCJ0ZXh0Q29udGVudCIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJjYXJkSWQiLCJtZXRob2QiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiZ2VuZXJhdGVDYXJkIiwiX2NhcmRFbGVtZW50IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfYnV0dG9uRWxlbWVudCIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2dldEVycm9yRWxlbWVudCIsImlucHV0RWxlbWVudCIsIl9zaG93RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2hpZGVFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJpbnB1dCIsImZvckVhY2giLCJpc0ludmFsaWQiLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldFZhbGlkYXRpb24iLCJzZWxlY3RvcnMiLCJwYWdlU2VsZWN0b3IiLCJwcm9maWxlTW9kYWxTZWxlY3RvciIsInBsYWNlTW9kYWxTZWxlY3RvciIsImltYWdlTW9kYWxTZWxlY3RvciIsInByb2ZpbGVOYW1lU2VsZWN0b3IiLCJwcm9maWxlSm9iU2VsZWN0b3IiLCJwcm9maWxlSW1hZ2VTZWxlY3RvciIsImNhcmRzTGlzdFNlbGVjdG9yIiwiY2xvc2VNb2RhbEJ1dHRvblNlbGVjdG9yIiwibW9kYWxJbWFnZVNlbGVjdG9yIiwibW9kYWxJbWFnZVRpdGxlU2VsZWN0b3IiLCJkZWxldGVDYXJkTW9kYWxTZWxlY3RvciIsImVkaXRBdmF0YXJNb2RhbFNlbGVjdG9yIiwiUG9wdXAiLCJfcmVmIiwic2VsZWN0b3IiLCJfcG9wdXAiLCJfcGFnZSIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlT3ZlcmxheUNsaWNrIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2xvc2VCdXR0b24iLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9zdWJtaXRCdG4iLCJfc3VibWl0QnRuVGV4dCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwidmFsdWUiLCJnZXRGb3JtIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwic2V0SW5wdXRWYWx1ZXMiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJfcmVxdWVzdCIsInVybCIsIm9wdGlvbnMiLCJmZXRjaCIsInRoZW4iLCJnZXRVc2VySW5mbyIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwiam9iIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImdldEluaXRpYWxDYXJkcyIsImdldERhdGEiLCJhbGwiLCJfcmVmMyIsInVzZXJJbmZvIiwiY2FyZHMiLCJhZGRDYXJkIiwiX3JlZjQiLCJkZWxldGVDYXJkIiwiX3JlZjUiLCJzbGljZSIsImxpa2VDYXJkIiwiX3JlZjYiLCJlZGl0QXZhdGFyVXJsIiwiX3JlZjciLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJhZGRQbGFjZUJ1dHRvbiIsImVkaXRBdmF0YXJFbGVtZW50IiwiZm9ybVZhbGlkYXRvcnMiLCJjYXJkc0xpc3QiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInNldEl0ZW1zIiwiaXRlbXMiLCJfaXRlbXMiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJjYXJkRWxlbWVudCIsImFkZEl0ZW0iLCJlbGVtZW50IiwiZ2V0Q2FyZEVsZW1lbnQiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX3Byb2ZpbGVJbWFnZSIsImF2YXRhclVybCIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyIiwidXNlckRhdGEiLCJyZXZlcnNlIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJwcm9maWxlUG9wdXAiLCJoYW5kbGVTdWJtaXQiLCJhZGRQbGFjZVBvcHVwIiwibmV3Q2FyZCIsInNhdmVkQ2FyZCIsImVkaXRBdmF0YXJQb3B1cCIsImltYWdlUG9wdXAiLCJfaW1hZ2VFbGVtZW50IiwiX2ltYWdlVGl0bGUiLCJkZWxldGVDYXJkUG9wdXAiLCJfY29uZmlybUJ1dHRvbiIsIl9kZWxldGVDYXJkIiwiX2NhcmRJZCIsInNldENhcmRJZCIsImZpbmFsbHkiLCJyZXF1ZXN0IiwicG9wdXBJbnN0YW5jZSIsInJlc2V0IiwiZm9ybXMiLCJ2YWxpZGF0b3IiLCJnZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9